<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Gestione Dati</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-light">
    {% include 'partials/navbar.html' %}
<div class="container py-5">
    <h2 class="mb-4">Convocazioni inserite</h2>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Data e Ora</th>
                <th>Squadre</th>
                <th>Sport</th>
                <th>Indennizzo</th>
                <th>Trasferta</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
        {% for c in convocazioni %}
            <tr>
                <td>{{ c['data_inizio'] }}</td>
                <td>{{ c['squadre'] }}</td>
                <td>{{ c['sport'] }}</td>
                <td>{{ c['indennizzo'] }} €</td>
                <td>{{ c['trasferta'] }} CHF</td>
                <td>
                    <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#editModal{{ c['id'] }}">Modifica</button>
                    <form action="/delete/{{ c['id'] }}" method="post" style="display:inline-block;" onsubmit="return confirm('Sei sicuro di voler eliminare questa convocazione?');">
                        <button class="btn btn-sm btn-danger">Elimina</button>
                    </form>

                    <!-- Modal -->
                    <div class="modal fade" id="editModal{{ c['id'] }}" tabindex="-1">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <form action="/update/{{ c['id'] }}" method="post">
                              <div class="modal-header">
                                <h5 class="modal-title">Modifica Convocazione</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                              </div>
                              <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label">Data e ora partita</label>
                                    <input type="datetime-local" name="data_inizio" value="{{ c['data_inizio'] }}" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Orario partenza</label>
                                    <input type="datetime-local" name="orario_partenza" value="{{ c['orario_partenza'] }}" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Sport</label>
                                    <select name="sport" class="form-select">
                                        <option value="inline-hockey" {% if c['sport'] == 'inline-hockey' %}selected{% endif %}>Inline-Hockey</option>
                                        <option value="ghiaccio" {% if c['sport'] == 'ghiaccio' %}selected{% endif %}>Hockey su ghiaccio</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Squadre</label>
                                    <input type="text" name="squadre" value="{{ c['squadre'] }}" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Luogo</label>
                                    <input type="text" name="luogo" value="{{ c['luogo'] }}" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Trasferta (CHF)</label>
                                    <input type="number" step="0.01" name="trasferta" value="{{ c['trasferta'] }}" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Indennizzo (€)</label>
                                    <input type="number" step="0.01" name="indennizzo" value="{{ c['indennizzo'] }}" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Note</label>
                                    <textarea name="note" class="form-control">{{ c['note'] }}</textarea>
                                </div>
                              </div>
                              <div class="modal-footer">
                                <button type="submit" class="btn btn-primary">Salva</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                              </div>
                          </form>
                        </div>
                      </div>
                    </div>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
